<section>
    <header>
        <div fxLayout="row">
            <div fxFlex="">
                <span class="badge">Report</span>
            </div>
            <div fxFlexAlign="end center" fxLayout="row" fxLayoutGap="20px">
            </div>
        </div>
        <div fxLayout="row">
            <div fxFlex="">
                <h1>{{ historicalTask.ata }} / {{ historicalTask.barcode }}</h1>
            </div>
            <div fxFlexAlign="end center" fxLayout="row" >
                <button [color]="primary" [disabled]="!analyzedTask.apply" (click)="copyText()" mat-raised-button type="button">Copy text</button>
            </div>
        </div>
    </header>
    <hr>
    <content>
        <div id="description">
            <h2>Description</h2>
            <p>{{historicalTask.description}}</p>
        </div>
        <div id="job-steps" *ngIf="historicalTask.steps.length > 0">
            <hr class="segment">
            <h2>Job Steps</h2>
            <mat-accordion>
                <mat-expansion-panel *ngFor="let step of historicalTask.steps; let i = index" [expanded]="i === 0">
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            Step {{step.ord}} | {{step.status}}
                        </mat-panel-title>
                        <mat-panel-description>
                             {{ step.createDate.epochTime | utcDate | date: 'dd-MM-yyyy HH:mm' }}
                        </mat-panel-description>
                    </mat-expansion-panel-header>
                    <div [innerHtml]="step.description"></div>
                    <ol *ngIf="step.stepLabours.length > 0">
                        <li *ngFor="let labour of step.stepLabours">
                            <span>Id: {{labour.labourId}} | Creation: {{labour.createDate.epochTime | utcDate | date: 'dd-MM-yyyy HH:mm'}} | Update: {{labour.reviseDate.epochTime | utcDate | date: 'dd-MM-yyyy HH:mm'}}</span>
                            <div [innerHtml]="labour.notes"></div>
                        </li>
                    </ol>
                </mat-expansion-panel>
            </mat-accordion>
        </div>
        <div id="maintenance-actions" *ngIf="historicalTask.correctiveActions.length > 0">
            <hr class="segment">
            <h2>Maintenance Actions</h2>
            <mat-accordion>
                <mat-expansion-panel *ngFor="let action of historicalTask.correctiveActions; let i = index" [expanded]="i === 0">
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            Action {{i+1}}
                        </mat-panel-title>
                        <mat-panel-description>
                            {{ action.actionDate.epochTime | utcDate | date: 'dd-MM-yyyy HH:mm' }} |
                            {{ action.updateDate.epochTime | utcDate | date: 'dd-MM-yyyy HH:mm' }}
                        </mat-panel-description>
                    </mat-expansion-panel-header>
                    <p>{{action.name.firstName}} {{action.name.lastName}}</p>
                    <div [innerHtml]="action.description"></div>
                </mat-expansion-panel>
            </mat-accordion>
        </div>
    </content>
</section>
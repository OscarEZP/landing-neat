<section *ngIf="analyzedTask">
    <header>
        <div fxLayout="row">
            <div fxFlex="">
                <span class="badge" [ngClass]="taskType.toLowerCase()">{{taskType}}</span>
            </div>
            <div fxFlexAlign="end center" fxLayout="row" fxLayoutGap="20px">
            </div>
        </div>
        <div fxLayout="row">
            <div fxFlex="">
                <h1>{{ historicalTask.ata }} / {{ historicalTask.barcode }}</h1>
            </div>
            <div fxFlexAlign="end center" fxLayout="row" >
                <button [color]="primary" (click)="copyText()" mat-raised-button type="button">Copy text</button>
            </div>
        </div>
    </header>
    <hr>
    <div class="content">
        <div id="fault-name">
            <h2>{{'FLEET_HEALTH.REPORT.FAULT_NAME' | translate}}</h2>
            <p>{{historicalTask.faultName}}</p>
        </div>
        <div id="description">
            <mat-accordion>
                <mat-expansion-panel [expanded]="true">
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            {{'FLEET_HEALTH.REPORT.DESCRIPTION' | translate}}
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <div [innerHtml]="historicalTask.description?historicalTask.description:'-'"></div>
                </mat-expansion-panel>
            </mat-accordion>
        </div>
        <div id="maintenance-actions" *ngIf="historicalTask.correctiveActions.length > 0">
            <hr class="segment">
            <h2>{{'FLEET_HEALTH.REPORT.MAINTENANCE_ACTIONS' | translate}}</h2>
            <mat-accordion>
                <mat-expansion-panel *ngFor="let action of historicalTask.correctiveActions; let i = index" [expanded]="i === 0">
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            {{'FLEET_HEALTH.REPORT.MAINTENANCE_ACTION' | translate}} {{i+1}}
                        </mat-panel-title>
                        <mat-panel-description>
                            {{ action.actionDate.epochTime | utcDate | date: 'dd-MM-yyyy HH:mm' }} |
                            {{ action.updateDate.epochTime | utcDate | date: 'dd-MM-yyyy HH:mm' }}
                        </mat-panel-description>
                    </mat-expansion-panel-header>
                    <p>{{action.name.firstName}} {{action.name.lastName}}</p>
                    <div [innerHtml]="action.description"></div>
                </mat-expansion-panel>
            </mat-accordion>
        </div>
        <div id="job-steps" *ngIf="historicalTask.steps.length > 0">
            <hr class="segment">
            <h2>{{'FLEET_HEALTH.REPORT.JOB_STEPS' | translate}}</h2>
            <mat-accordion>
                <mat-expansion-panel *ngFor="let step of historicalTask.steps; let i = index" [expanded]="i === 0">
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            {{'FLEET_HEALTH.REPORT.JOB_STEP' | translate}} {{step.ord}} | {{step.status}}
                        </mat-panel-title>
                        <mat-panel-description>
                            {{ step.createDate.epochTime | utcDate | date: 'dd-MM-yyyy HH:mm' }}
                        </mat-panel-description>
                    </mat-expansion-panel-header>
                    <div [innerHtml]="step.description"></div>
                    <ol *ngIf="step.stepLabours.length > 0">
                        <li *ngFor="let labour of step.stepLabours">
                            <span>Id: {{labour.labourId}} | Creation: {{labour.createDate.epochTime | utcDate | date: 'dd-MM-yyyy HH:mm'}} | Update: {{labour.reviseDate.epochTime | utcDate | date: 'dd-MM-yyyy HH:mm'}}</span>
                            <div [innerHtml]="labour.notes"></div>
                        </li>
                    </ol>
                </mat-expansion-panel>
            </mat-accordion>
        </div>
    </div>
</section>

<section *ngIf="analyzedTask === null">
    <p *ngIf="getRelatedTimelineData().length > 0">{{'FLEET_HEALTH.REPORT.MSG.NO_TASK_SELECTED' | translate}}</p>
    <p *ngIf="getRelatedTimelineData().length === 0">{{'FLEET_HEALTH.REPORT.MSG.NO_TASKS' | translate}}</p>
</section>

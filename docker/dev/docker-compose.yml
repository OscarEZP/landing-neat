# Declare compose version
version: '2'

# Define your services
services:

  web:  # Main web service
    container_name: moc_web
    build: ./    # Directory containing Dockerfile
    ports:  # Ports to expose
    - "4200:4200"
    volumes:    # Volumes (directories) to mount
    - ../../:/var/www/html/
    command: bash -c "npm install && ng serve --env=staging -o --host 0.0.0.0 --port 4200"

#  prod:  # Production web service
#    container_name: moc_prod
#    build: ./    # Directory containing Dockerfile
#    ports:  # Ports to expose
#    - "4200:4200"
#    volumes:    # Volumes (directories) to mount
#    - ../../:/var/www/html/
#    command: bash -c "ng serve -o --host 0.0.0.0 --port 4200"

  test:  # Test service
    container_name: moc_test
    build: ./    # Directory containing Dockerfile
    ports:  # Ports to expose
    - "9876:9876"
    volumes:    # Volumes (directories) to mount
    - ../../:/var/www/html/
    command: bash -c "npm install && ng test --env=staging -sm=false --code-coverage"
